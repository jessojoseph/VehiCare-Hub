{% extends 'base.html' %}

{% block title %}Roadside Assistance Request{% endblock %}

{% block content %}
<div class="container">
    <h1 class="mt-5 mb-4">Roadside Assistance Request</h1>
    <form action="/request_assistance/" method="post">
        {% csrf_token %}
        <div class="form-group mb-3">
            <label for="nameInput">Name:</label>
            <input type="text" class="form-control" id="nameInput" name="name" placeholder="" value="{{ logged_in_user_name }}" required>
        </div>        
        <div class="form-group mb-3">
            <label for="regNumberInput">Vehicle Registration Number:</label>
            <input type="text" class="form-control" id="regNumberInput" name="reg_number" placeholder="" required>
        </div>
        <div class="form-group mb-3">
            <label for="complaintTextarea">Description of the Issue:</label>
            <textarea class="form-control" id="complaintTextarea" name="complaint" rows="3" placeholder="" required></textarea>
        </div>
        <div class="form-group mb-3">
            <label for="locationInput">Location:</label>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group row">
                        <label for="latitude" class="col-sm-3 col-form-label">Latitude</label>
                        <div class="col-sm-9">
                            <input type="text" id="lat" name="latitude" class="form-control" required>
                            <span id="latspan" class="text-danger"></span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group row">
                        <label for="longitude" class="col-sm-3 col-form-label">Longitude</label>
                        <div class="col-sm-9">
                            <input type="text" id="long" name="longitude" class="form-control" required>
                            <span id="longspan" class="text-danger"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group mb-3">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <button type="button" onclick="getCoordinates()" class="btn btn-dark btn-sm">Get Coordinates</button>
                </div>
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Submit Request</button>
    </form>
</div>

<style>
    .btn-get-coordinates {
        margin-top: 10px; /* Adjust the top margin as needed */
    }
</style>

<script>
    function getCoordinates() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
        } else {
          alert("Geolocation is not supported by this browser.");
        }
      }
  
      function showPosition(position) {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;
      
        // Populate the latitude and longitude input fields with the obtained values
        document.getElementById('lat').value = latitude;
        document.getElementById('long').value = longitude;
      }
</script>
{% endblock %}
